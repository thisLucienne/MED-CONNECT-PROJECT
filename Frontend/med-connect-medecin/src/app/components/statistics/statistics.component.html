<div class="statistics-container">
  <!-- En-tête -->
  <div class="statistics-header">
    <div class="header-content">
      <h1>Rapports & Statistiques</h1>
      <p>Analyse des performances et données médicales</p>
    </div>
    <div class="header-actions">
      <select [(ngModel)]="selectedPeriod" class="period-select">
        <option value="week">Cette semaine</option>
        <option value="month">Ce mois</option>
        <option value="quarter">Ce trimestre</option>
        <option value="year">Cette année</option>
      </select>
      <button class="btn-export" (click)="exportReport()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M21 15V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V15M7 10L12 15M12 15L17 10M12 15V3" stroke="currentColor" stroke-width="2"/>
        </svg>
        Exporter
      </button>
      <button class="btn-generate" (click)="generateReport()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M9 12H15M9 16H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L18.7071 8.70711C18.8946 8.89464 19 9.149 19 9.41421V19C19 20.1046 18.1046 21 17 21Z" stroke="currentColor" stroke-width="2"/>
        </svg>
        Générer Rapport
      </button>
    </div>
  </div>

  <!-- Cartes de statistiques -->
  <div class="stats-cards">
    <div *ngFor="let card of statisticCards" class="stat-card" [class]="card.color">
      <div class="stat-icon">
        <svg *ngIf="card.icon === 'users'" viewBox="0 0 24 24" fill="none">
          <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45768C17.623 10.1593 16.8604 10.6597 16 10.88M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7Z" stroke="currentColor" stroke-width="2"/>
        </svg>
        <svg *ngIf="card.icon === 'calendar'" viewBox="0 0 24 24" fill="none">
          <path d="M8 2V6M16 2V6M3 10H21M5 4H19C20.1046 4 21 4.89543 21 6V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V6C3 4.89543 3.89543 4 5 4Z" stroke="currentColor" stroke-width="2"/>
        </svg>
        <svg *ngIf="card.icon === 'euro'" viewBox="0 0 24 24" fill="none">
          <path d="M12 2C13.1046 2 14 2.89543 14 4V20C14 21.1046 13.1046 22 12 22C10.8954 22 10 21.1046 10 20V4C10 2.89543 10.8954 2 12 2Z" stroke="currentColor" stroke-width="2"/>
          <path d="M9 9C9 5.13401 9 3 12 3C15 3 15 5.13401 15 9" stroke="currentColor" stroke-width="2"/>
        </svg>
        <svg *ngIf="card.icon === 'star'" viewBox="0 0 24 24" fill="none">
          <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <div class="stat-content">
        <h3>{{ card.title }}</h3>
        <div class="stat-value">{{ card.value }}</div>
        <div class="stat-change" [class]="card.changeType">
          {{ card.change }} vs période précédente
        </div>
      </div>
    </div>
  </div>

  <!-- Graphiques -->
  <div class="charts-section">
    <div class="chart-controls">
      <h2>Analyses Détaillées</h2>
      <div class="chart-tabs">
        <button 
          class="chart-tab"
          [class.active]="selectedChart === 'patients'"
          (click)="selectedChart = 'patients'"
        >
          Évolution Patients
        </button>
        <button 
          class="chart-tab"
          [class.active]="selectedChart === 'consultations'"
          (click)="selectedChart = 'consultations'"
        >
          Consultations
        </button>
        <button 
          class="chart-tab"
          [class.active]="selectedChart === 'pathologies'"
          (click)="selectedChart = 'pathologies'"
        >
          Pathologies
        </button>
      </div>
    </div>

    <!-- Graphique Patients -->
    <div *ngIf="selectedChart === 'patients'" class="chart-container">
      <h3>Évolution du Nombre de Patients</h3>
      <div class="bar-chart">
        <div *ngFor="let data of patientsData" class="bar-item">
          <div class="bar" [style.height.%]="getPercentage(data.value, getMaxValue(patientsData))" [style.background-color]="data.color">
            <span class="bar-value">{{ data.value }}</span>
          </div>
          <span class="bar-label">{{ data.label }}</span>
        </div>
      </div>
    </div>

    <!-- Graphique Consultations -->
    <div *ngIf="selectedChart === 'consultations'" class="chart-container">
      <h3>Consultations par Jour de la Semaine</h3>
      <div class="bar-chart">
        <div *ngFor="let data of consultationsData" class="bar-item">
          <div class="bar" [style.height.%]="getPercentage(data.value, getMaxValue(consultationsData))" [style.background-color]="data.color">
            <span class="bar-value">{{ data.value }}</span>
          </div>
          <span class="bar-label">{{ data.label }}</span>
        </div>
      </div>
    </div>

    <!-- Graphique Pathologies -->
    <div *ngIf="selectedChart === 'pathologies'" class="chart-container">
      <h3>Répartition des Pathologies</h3>
      <div class="pathologies-chart">
        <div *ngFor="let data of pathologiesData" class="pathology-item">
          <div class="pathology-info">
            <span class="pathology-name">{{ data.label }}</span>
            <span class="pathology-count">{{ data.value }} patients</span>
          </div>
          <div class="pathology-bar">
            <div class="pathology-fill" 
                 [style.width.%]="getPercentage(data.value, getMaxValue(pathologiesData))"
                 [style.background-color]="data.color">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Actions rapides -->
  <div class="quick-actions">
    <h2>Actions Rapides</h2>
    <div class="actions-grid">
      <button class="action-card" (click)="navigateToPatients()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2"/>
          <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
          <path d="M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13" stroke="currentColor" stroke-width="2"/>
          <path d="M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45768C17.623 10.1593 16.8604 10.6597 16 10.88" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h3>Voir Patients</h3>
        <p>Accéder à la liste complète</p>
      </button>

      <button class="action-card" (click)="navigateToAgenda()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M8 2V6M16 2V6M3 10H21M5 4H19C20.1046 4 21 4.89543 21 6V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V6C3 4.89543 3.89543 4 5 4Z" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h3>Agenda</h3>
        <p>Gérer les rendez-vous</p>
      </button>

      <button class="action-card" (click)="navigateToDashboard()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M3 12L5 10L12 17L22 7" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h3>Tableau de Bord</h3>
        <p>Vue d'ensemble</p>
      </button>

      <button class="action-card" (click)="exportReport()">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M21 15V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V15M7 10L12 15M12 15L17 10M12 15V3" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h3>Export Données</h3>
        <p>Télécharger les rapports</p>
      </button>
    </div>
  </div>
</div>